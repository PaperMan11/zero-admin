syntax = "proto3";

package main;

option go_package = "./proto";


// 用户登录请求
message LoginRequest {
  string username = 1;  // 用户名
  string password = 2;  // 密码
  string ip_address = 3;  // IP地址
  string os = 4; // 操作系统
  string browser = 5; // 浏览器
}

// 用户登录响应
message LoginResponse {
  int64 id = 1;           // 用户ID
  string username = 2;    // 用户名
  string token = 3;       // JWT令牌
  string refresh_token = 4; // 刷新令牌
}

// 刷新令牌请求
message RefreshTokenRequest {
  string refresh_token = 1; // 刷新令牌
}

// 刷新令牌响应
message RefreshTokenResponse {
  string token = 1;       // 新的JWT令牌
  string refresh_token = 2; // 新的刷新令牌
}

// 获取当前用户信息请求
message GetCurrentUserRequest {
  int64 user_id = 1;
}

// 用户信息
message UserInfo {
  int64 id = 1;           // 用户ID
  string username = 2;    // 用户名
  string email = 3;       // 邮箱
  string mobile = 4;      // 手机号
  string real_name = 5;   // 真实姓名
  int32 gender = 6;       // 性别 (0-未知, 1-男, 2-女)
  int32 status = 7;       // 状态 (0-禁用, 1-正常)
  repeated Role roles = 8; // 角色列表
  repeated Menu menu_tree = 9; // 菜单列表
  string avatar = 10;     // 头像
}

// 角色信息
message Role {
  int64 id = 1;           // 角色ID
  string role_name = 2;   // 角色名称
  string role_code = 3;   // 角色编码
}

// 认证服务
service AuthService {
  // 用户登录
  rpc Login(LoginRequest) returns (LoginResponse);

  // 刷新令牌
  rpc RefreshToken(RefreshTokenRequest) returns (RefreshTokenResponse);

  // 获取当前用户信息
  rpc GetCurrentUser(GetCurrentUserRequest) returns (UserInfo);
}