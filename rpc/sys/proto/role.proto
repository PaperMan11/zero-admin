syntax = "proto3";

package main;

option go_package = "./proto";


// 角色信息
message Role {
  int64 role_id = 1;      // 角色ID
  string role_name = 2;   // 角色名称
  string role_code = 3;   // 角色编码
  string description = 4; // 角色描述
  int32 status = 5;    // 状态（0-禁用，1-正常）
}

message RoleScope {
  int64 id = 1;
  string role_code = 2;
  string scope_code = 3;
  int32 perm = 4;
}

message RoleScopeInfo {
  Scope scope = 1;
  repeated string perms = 2;
}

message RoleInfo {
  Role role = 1;
  repeated RoleScopeInfo scopes = 2;
}


// 角色列表请求
message RoleListRequest {
  PageRequest page_request = 1;
  int32 status = 2;       // 状态过滤
}

// 角色列表响应
message RoleListResponse {
  PageResponse page_response = 1;
  repeated Role roles = 2;
}


// 创建角色请求
message CreateRoleRequest {
  string role_name = 1;   // 角色名称
  string role_code = 2;   // 角色编码
  string description = 3; // 角色描述
  int32 status = 4;       // 状态 (0-禁用, 1-正常)
  repeated int64 scope_ids = 5; // 安全范围id
  int64 operator_id = 6;  // 操作者
}

// 更新角色请求
message UpdateRoleRequest {
  int64 role_id = 1;           // 角色ID
  string role_name = 2;   // 角色名称
  string role_code = 3;   // 角色编码
  string description = 4; // 角色描述
  int32 status = 5;       // 状态 (0-禁用, 1-正常)
  int64 operator_id = 6;  // 操作者
}

// 删除角色请求
message DeleteRoleRequest {
  int64 id = 1;           // 角色ID
  int64 operator_id = 2;  // 操作者
}

message AddRolePermsRequest {
  int64 role_id = 1;           // 角色ID
  string role_code = 2;   // 角色code
  int64 operator_id = 3;  // 操作者
  repeated RoleScope role_scopes = 4;
}

message UpdateRolePermsRequest {
  int64 role_id = 1;      // 角色ID
  string role_code = 2;   // 角色code
  int64 operator_id = 3;  // 操作者
  repeated RoleScope role_scopes = 4;
}

message DeleteRolePermsRequest {
  int64 role_id = 1;      // 角色ID
  string role_code = 2;   // 角色code
  int64 operator_id = 3;  // 操作者
  repeated string scope_codes = 4;
}


service RoleService {
  // 角色列表
  rpc GetRoleList(RoleListRequest) returns (RoleListResponse);
  // 创建角色
  rpc CreateRole(CreateRoleRequest) returns (Role);
  // 更新角色
  rpc UpdateRole(UpdateRoleRequest) returns (Role);
  // 删除角色
  rpc DeleteRole(DeleteRoleRequest) returns (Empty);
  // 添加角色权限
  rpc AddRolePerms(AddRolePermsRequest) returns (RoleInfo);
  // 更新角色权限
  rpc UpdateRolePerms(UpdateRolePermsRequest) returns (RoleInfo);
  // 删除角色权限
  rpc DeleteRolePerms(DeleteRolePermsRequest) returns (RoleInfo);
  // 获取角色权限
  rpc GetRolePerms(Int64Value) returns (RoleInfo);
}

